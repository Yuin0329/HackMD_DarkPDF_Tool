// 清除之前的樣式
const oldStyle = document.querySelector('style[data-dark-theme]');
if (oldStyle) oldStyle.remove();

// 注入修正版暗色主題樣式
const darkStyle = document.createElement('style');
darkStyle.setAttribute('data-dark-theme', 'true');
darkStyle.textContent = `
  @media print {
    * {
      -webkit-print-color-adjust: exact !important;
      color-adjust: exact !important;
    }
    
    body, .ui-content, .markdown-body, .ui-layout-center {
      background-color: #1a1a1a !important;
      color: #e0e0e0 !important;
    }
    
    h1, h2, h3, h4, h5, h6 {
      color: #ffffff !important;
    }
    
    p, li, td, th, span, div {
      color: #e0e0e0 !important;
    }
    
    strong, b {
      color: #ffffff !important;
    }
    
    a {
      color: #66b3ff !important;
    }
    
    code {
      background-color: #2d2d2d !important;
      color: #f8f8f2 !important;
      border: 1px solid #444 !important;
    }
    
    pre {
      background-color: #2d2d2d !important;
      color: #f8f8f2 !important;
      border: 1px solid #444 !important;
    }
    
    blockquote {
      background-color: #2a2a2a !important;
      color: #cccccc !important;
      border-left: 4px solid #666 !important;
    }
    
    table {
      background-color: #1a1a1a !important;
      color: #e0e0e0 !important;
    }
    
    th {
      background-color: #2d2d2d !important;
      color: #ffffff !important;
    }
    
    tr:nth-child(even) {
      background-color: #252525 !important;
    }
    
    hr {
      border-color: #444 !important;
    }
  }
`;
document.head.appendChild(darkStyle);
console.log('暗色主題已套用，現在可以列印了！記得勾選"背景圖形"選項');